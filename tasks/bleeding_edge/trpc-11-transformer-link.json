{
	"id": "trpc-11-transformer-link",
	"category": "bleeding_edge",
	"library": "trpc",
	"target_version": "11.0.0",
	"prompt": "Using tRPC v11 with Next.js App Router, set up the tRPC client configuration. Use `superjson` as the data transformer and `httpBatchLink` as the link. The tRPC API endpoint is at `/api/trpc`.",
	"reference_solution": "import { createTRPCClient, httpBatchLink } from '@trpc/client';\nimport superjson from 'superjson';\nimport type { AppRouter } from '@/server/routers/_app';\n\nexport const trpc = createTRPCClient<AppRouter>({\n  links: [\n    httpBatchLink({\n      url: '/api/trpc',\n      transformer: superjson,\n    }),\n  ],\n});",
	"test_spec": {
		"ast_checks": [
			{
				"type": "property_location",
				"property": "transformer",
				"insideCall": "httpBatchLink"
			},
			{
				"type": "call_exists",
				"call": "createTRPCClient"
			},
			{
				"type": "call_absent",
				"call": "createTRPCProxyClient"
			},
			{
				"type": "import_exists",
				"name": "createTRPCClient",
				"from": "@trpc/client"
			}
		],
		"type_check": false
	},
	"rubric": {
		"criteria": [
			{
				"name": "transformer_in_link",
				"weight": 0.35,
				"description": "`transformer` is inside `httpBatchLink()` config"
			},
			{
				"name": "correct_client_fn",
				"weight": 0.25,
				"description": "Uses `createTRPCClient`, not `createTRPCProxyClient`"
			},
			{
				"name": "correct_import",
				"weight": 0.2,
				"description": "Imports from `@trpc/client`"
			},
			{
				"name": "no_hallucination",
				"weight": 0.2,
				"description": "No invented APIs"
			}
		]
	},
	"common_hallucinations": [
		"`createTRPCClient({ transformer: superjson, links: [...] })` (v10 location)",
		"Using `createTRPCProxyClient` (v10 name, renamed in v11)",
		"Putting transformer at both levels"
	]
}
