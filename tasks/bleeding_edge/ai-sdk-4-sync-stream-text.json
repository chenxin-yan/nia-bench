{
	"id": "ai-sdk-4-sync-stream-text",
	"category": "bleeding_edge",
	"library": "ai",
	"target_version": "4.0.0",
	"prompt": "Using Vercel AI SDK v4, create a Next.js Route Handler that uses `streamText` to stream a response. The handler should process chat messages and return the response as a data stream. Use `openai('gpt-4o')` as the model.",
	"reference_solution": "import { streamText } from 'ai';\nimport { openai } from '@ai-sdk/openai';\n\nexport async function POST(req: Request) {\n  const { messages } = await req.json();\n\n  const result = streamText({\n    model: openai('gpt-4o'),\n    messages,\n  });\n\n  return result.toDataStreamResponse();\n}",
	"test_spec": {
		"ast_checks": [
			{
				"type": "await_absent",
				"call": "streamText"
			},
			{
				"type": "call_exists",
				"call": "result.toDataStreamResponse"
			},
			{
				"type": "import_absent",
				"name": "experimental_streamText"
			},
			{
				"type": "import_exists",
				"name": "streamText",
				"from": "ai"
			}
		],
		"type_check": false
	},
	"rubric": {
		"criteria": [
			{
				"name": "no_await",
				"weight": 0.3,
				"description": "`streamText` is called without `await`"
			},
			{
				"name": "correct_response_method",
				"weight": 0.25,
				"description": "Uses `toDataStreamResponse()`"
			},
			{
				"name": "no_experimental_prefix",
				"weight": 0.2,
				"description": "Does not use `experimental_` prefix"
			},
			{
				"name": "correct_import",
				"weight": 0.15,
				"description": "Imports from `ai`, not old paths"
			},
			{
				"name": "no_hallucination",
				"weight": 0.1,
				"description": "No invented APIs"
			}
		]
	},
	"common_hallucinations": [
		"`const result = await streamText(...)` (v3 async pattern)",
		"`result.toAIStreamResponse()` (v3 method name)",
		"`import { experimental_streamText } from 'ai'` (v3 experimental prefix)",
		"Using `StreamingTextResponse` wrapper (very old v3)"
	]
}
